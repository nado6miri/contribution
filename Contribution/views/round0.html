<!DOCTYPE html>
<style>
    .fixed_header {
        width: 1200px;
        border-collapse: collapse;
    }

        .fixed_header tbody {
            display: block;
            width: 100%;
            height: 800px;
        }

        .fixed_header thead tr {
            display: block;
        }

        .fixed_header thead {
            background: black;
            color: #fff;
        }

        .fixed_header th, .fixed_header td {
            padding: 2px;
            text-align: left;
            width: 200px;
        }
</style>


<html>
<head>
    <title></title>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
</head>

<body>
    <b>Donation : Small Round</b>
    <div id="sminfo_div">
        <span id=msgs></span>
        <table id="donate_list" border="1" class="fixed_header">
            <thead>
            <th>Round No</th>
            <th>Order</th>
            <th>Time</th>
            <th>Donator</th>
            <th>Amount</th>
            <th>SYM</th>
            <th>Lucky Code</th>
            <th>TxID</th>
            </thead>
            <tbody id="insert_sminfo_table">
                <!--
                <tr><td>S00001</td><td>1</td><td>2018/10/15-09:00:34</td><td>iloveyoutube</td><td>1</td><td>EOS</td><td>55</td><td>7893...2344</td></tr>
                <tr><td>S00001</td><td>2</td><td>2018/10/15-09:00:35</td><td>ilovelgtwins</td><td>100</td><td>GOLD</td><td>35</td><td>3293...2233</td></tr>
                -->
            </tbody>
        </table>
    </div>
    <div>
        <b>Send message</b>
        <p>Message  <input type="text" id="cmdbox" />
    </div>
</body>
</html>

<script type="text/javascript">
    //var socket = io.connect('http://localhost:3000');
    var socket = io.connect('http://localhost:5555');
    var SYM = ['EOS', 'GOLD'];

    socket.on('insert_last', function (data) {
        console.log("Insert Table");
        $('#msgs').text(data.msg + '==Insert Table');
        //$('#donate_list > tbody:last').append('<tr><td>Last</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>');
        var my_tbody = document.getElementById('insert_sminfo_table');
        var row = my_tbody.insertRow(my_tbody.rows.length); // 하단에 추가
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        cell1.innerHTML = data.id;
        cell2.innerHTML = data.roundid;
        cell3.innerHTML = data.jointime;
        cell4.innerHTML = data.donator;
        cell5.innerHTML = data.donamteamt;
        cell6.innerHTML = SYM[data.donatetype];
        cell7.innerHTML = data.luckycode;
        cell8.innerHTML = "txid";
    });

    socket.on('insert_first', function (data) {
        console.log("Insert Table");
        $('#msgs').text(data.msg + '==Insert Table');
        //$('#donate_list > tbody').append('<tr><td>First</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>');
        var my_tbody = document.getElementById('insert_sminfo_table');
        var row = my_tbody.insertRow(0); // 상단에 추가
        //var row = my_tbody.insertRow(my_tbody.rows.length); // 하단에 추가
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        cell1.innerHTML = data.id;
        cell2.innerHTML = data.roundid;
        cell3.innerHTML = data.jointime;
        cell4.innerHTML = data.donator;
        cell5.innerHTML = data.donamteamt;
        cell6.innerHTML = SYM[data.donatetype];
        cell7.innerHTML = data.luckycode;
        cell8.innerHTML = "txid";
    });

    socket.on('update', function (data) {
        console.log("update / Insert Table");
        $('#msgs').text(data.msg + '==Insert Table');
        var my_tbody = document.getElementById('insert_sminfo_table');
        var row = my_tbody.insertRow(my_tbody.rows.length); // 하단에 추가
        var cell1 = row.insertCell(0);
        var cell2 = row.insertCell(1);
        var cell3 = row.insertCell(2);
        var cell4 = row.insertCell(3);
        var cell5 = row.insertCell(4);
        var cell6 = row.insertCell(5);
        var cell7 = row.insertCell(6);
        var cell8 = row.insertCell(7);
        cell1.innerHTML = data.id;
        cell2.innerHTML = data.roundid;
        cell3.innerHTML = data.jointime;
        cell4.innerHTML = data.donator;
        cell5.innerHTML = data.donamteamt;
        cell6.innerHTML = SYM[data.donatetype];
        cell7.innerHTML = data.luckycode;
        cell8.innerHTML = "txid";
    });

    //===========================================================
    $("#cmdbox").keyup(function (event) {
        if (event.which == 13) {
            socket.emit('clientcmd', { msg: $('#cmdbox').val() });
            $('#cmdbox').val('');
        }
    });
</script>

<!--
   scrollable table....
   https://medium.com/@vembarrajan/html-css-tricks-scroll-able-table-body-tbody-d23182ae0fbc
-->
